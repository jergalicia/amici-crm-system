{% extends "base.html" %}

{% block content %}
<div class="header">
    <div class="page-title">Manuales y Protocolos</div>
    {% if current_user.role == 'admin' %}
    <a href="{{ url_for('manuals.create') }}" class="btn-primary"
        style="text-decoration: none; width: auto; display: inline-block;">+ Subir Manual</a>
    {% endif %}
</div>

<div class="card">
    <p style="margin-bottom: 1.5rem; color: var(--text-light);">
        A continuaciÃ³n encontrarÃ¡s los documentos y protocolos asignados a tu rol de <strong>{{ current_user.role |
            capitalize }}</strong>.
    </p>

    {% if manuals %}
    <div style="display: flex; flex-direction: column; gap: 1rem;">
        {% for manual in manuals %}
        <div
            style="display: flex; align-items: center; justify-content: space-between; padding: 1rem; border: 1px solid var(--gray-200); border-radius: var(--radius-md); background: white;">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <div style="font-size: 1.5rem; color: var(--primary-red);">ğŸ“„</div>
                <div>
                    <div style="font-weight: 500; font-size: 1rem;">{{ manual.name }}</div>
                    <div style="font-size: 0.8rem; color: var(--text-light);">
                        Rol: {{ manual.target_role | capitalize }} â€¢ Subido: {{ manual.uploaded_at.strftime('%Y-%m-%d')
                        }}
                    </div>
                </div>
            </div>

            <div style="display: flex; gap: 0.5rem; align-items: center;">
                <a href="{{ url_for('manuals.view_pdf', filename=manual.filename) }}" target="_blank"
                    class="btn-primary" style="padding: 0.5rem 1rem; font-size: 0.9rem; text-decoration: none;">Ver
                    Documento</a>

                {% if current_user.role == 'admin' %}
                <a href="{{ url_for('manuals.edit', id=manual.id) }}"
                    style="padding: 0.5rem; text-decoration: none; font-size: 1.2rem;" title="Editar">âœï¸</a>

                <form action="{{ url_for('manuals.delete', id=manual.id) }}" method="POST" style="display:inline;"
                    onsubmit="return confirm('Â¿Eliminar este manual?');">
                    <button type="submit" style="background: none; border: none; cursor: pointer; font-size: 1.2rem;"
                        title="Eliminar">ğŸ—‘ï¸</button>
                </form>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div style="text-align: center; padding: 3rem;">
        <p style="color: var(--text-light);">No hay manuales disponibles para tu rol.</p>
    </div>
    {% endif %}
</div>
{% endblock %}
